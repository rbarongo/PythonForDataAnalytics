{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "5513a62b",
   "metadata": {},
   "source": [
    "#### PYTHON FOR DATA ANALYTICS\n",
    "#### DAY 5 on  30 DEC 2021"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0f823b95",
   "metadata": {},
   "outputs": [],
   "source": [
    "\"\"\"\"\n",
    "Agenda\n",
    "(1)Recap on Pandas and Numpy\n",
    "(2)Data analysis with Pandas\n",
    "\n",
    "\"\"\""
   ]
  },
  {
   "cell_type": "markdown",
   "id": "818fd96f",
   "metadata": {},
   "source": [
    "### (1) Recap introduction to Pandas\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "de4d9099",
   "metadata": {},
   "source": [
    "#### (2) Data Analysis with Pandas"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 182,
   "id": "0d3fd5f3",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 183,
   "id": "276cfa9a",
   "metadata": {},
   "outputs": [],
   "source": [
    "columns_list = ['Institutions','Loan_classification','Customer_age','Loan_amount','Region']\n",
    "data = {\"Bank\": [\"CRDB\", \"CRDB\", \"CRDB\", \"CRDB\", \"CRDB\", \"CRDB\", \"NMB\", \"NMB\", \"NMB\", \"NMB\", \"NMB\", \"NMB\"],\n",
    "\"Classification\": [\"Current\", \"Current\", \"Substandard\", \"Substandard\", \"Substandard\", \"Loss\", \"ESM\", \"Loss\", \"Doubtful\", \"ESM\", \"ESM\", \"Current\"],\n",
    "\"Age\": [24, 28, 40, 22, 29, 33, 31, 26, 21, 36, 25, 31],\n",
    "\"Amount\": [3424, 54328, 4034, 34522, 3529, 3433, 34531, 23556, 2441, 3356, 325, 4531],\n",
    "\"Location\":['Dar','Aru','Mza','Mby','Dar','Aru','Tan','Mza','Mby','Mby','Mby','Dar'] }\n",
    "#df = pd.DataFrame(data, columns=['Institutions', 'Loan_classification', 'Customer_age', 'Loan_amount', 'Region'])\n",
    "df = pd.DataFrame(data)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 185,
   "id": "deb08e0b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Bank</th>\n",
       "      <th>Classification</th>\n",
       "      <th>Age</th>\n",
       "      <th>Amount</th>\n",
       "      <th>Location</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>CRDB</td>\n",
       "      <td>Current</td>\n",
       "      <td>24</td>\n",
       "      <td>3424</td>\n",
       "      <td>Dar</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>CRDB</td>\n",
       "      <td>Current</td>\n",
       "      <td>28</td>\n",
       "      <td>54328</td>\n",
       "      <td>Aru</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>CRDB</td>\n",
       "      <td>Substandard</td>\n",
       "      <td>40</td>\n",
       "      <td>4034</td>\n",
       "      <td>Mza</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>CRDB</td>\n",
       "      <td>Substandard</td>\n",
       "      <td>22</td>\n",
       "      <td>34522</td>\n",
       "      <td>Mby</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>CRDB</td>\n",
       "      <td>Substandard</td>\n",
       "      <td>29</td>\n",
       "      <td>3529</td>\n",
       "      <td>Dar</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Bank Classification  Age  Amount Location\n",
       "0  CRDB        Current   24    3424      Dar\n",
       "1  CRDB        Current   28   54328      Aru\n",
       "2  CRDB    Substandard   40    4034      Mza\n",
       "3  CRDB    Substandard   22   34522      Mby\n",
       "4  CRDB    Substandard   29    3529      Dar"
      ]
     },
     "execution_count": 185,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Display dataframe\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fd95a856",
   "metadata": {},
   "outputs": [],
   "source": [
    "#View information about columns\n",
    "df.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 187,
   "id": "328db3ab",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:xlabel='Classification'>"
      ]
     },
     "execution_count": 187,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "#df.groupby(['Location']).mean()\n",
    "#df.groupby(['Bank']).mean()\n",
    "df3 = df.groupby(['Classification']).mean()\n",
    "df3.plot()\n",
    "#df3.plot(x = df3['Age'], y =  df3['Amount'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 188,
   "id": "6c280245",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Age</th>\n",
       "      <th>Amount</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Bank</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>CRDB</th>\n",
       "      <td>29.333333</td>\n",
       "      <td>17211.666667</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>NMB</th>\n",
       "      <td>28.333333</td>\n",
       "      <td>11456.666667</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            Age        Amount\n",
       "Bank                         \n",
       "CRDB  29.333333  17211.666667\n",
       "NMB   28.333333  11456.666667"
      ]
     },
     "execution_count": 188,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Group by one of columns\n",
    "df.groupby(['Bank']).mean()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "895062e5",
   "metadata": {},
   "outputs": [],
   "source": [
    "df.groupby(level=0).mean()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 189,
   "id": "089385b4",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Age</th>\n",
       "      <th>Amount</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Classification</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Current</th>\n",
       "      <td>83</td>\n",
       "      <td>62283</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Doubtful</th>\n",
       "      <td>21</td>\n",
       "      <td>2441</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ESM</th>\n",
       "      <td>92</td>\n",
       "      <td>38212</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Loss</th>\n",
       "      <td>59</td>\n",
       "      <td>26989</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Substandard</th>\n",
       "      <td>91</td>\n",
       "      <td>42085</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                Age  Amount\n",
       "Classification             \n",
       "Current          83   62283\n",
       "Doubtful         21    2441\n",
       "ESM              92   38212\n",
       "Loss             59   26989\n",
       "Substandard      91   42085"
      ]
     },
     "execution_count": 189,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Group by, including null values\n",
    "df.groupby(by=[\"Classification\"], dropna=False).sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 190,
   "id": "7f88fbbe",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>Age</th>\n",
       "      <th>Amount</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Bank</th>\n",
       "      <th>Classification</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th rowspan=\"3\" valign=\"top\">CRDB</th>\n",
       "      <th>Current</th>\n",
       "      <td>52</td>\n",
       "      <td>57752</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Loss</th>\n",
       "      <td>33</td>\n",
       "      <td>3433</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Substandard</th>\n",
       "      <td>91</td>\n",
       "      <td>42085</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"4\" valign=\"top\">NMB</th>\n",
       "      <th>Current</th>\n",
       "      <td>31</td>\n",
       "      <td>4531</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Doubtful</th>\n",
       "      <td>21</td>\n",
       "      <td>2441</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ESM</th>\n",
       "      <td>92</td>\n",
       "      <td>38212</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Loss</th>\n",
       "      <td>26</td>\n",
       "      <td>23556</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                     Age  Amount\n",
       "Bank Classification             \n",
       "CRDB Current          52   57752\n",
       "     Loss             33    3433\n",
       "     Substandard      91   42085\n",
       "NMB  Current          31    4531\n",
       "     Doubtful         21    2441\n",
       "     ESM              92   38212\n",
       "     Loss             26   23556"
      ]
     },
     "execution_count": 190,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.groupby(by=[\"Bank\", \"Classification\"]).sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 191,
   "id": "b0cfac25",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>Age</th>\n",
       "      <th>Amount</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Bank</th>\n",
       "      <th>Classification</th>\n",
       "      <th>Location</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th rowspan=\"6\" valign=\"top\">CRDB</th>\n",
       "      <th rowspan=\"2\" valign=\"top\">Current</th>\n",
       "      <th>Aru</th>\n",
       "      <td>28</td>\n",
       "      <td>54328</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Dar</th>\n",
       "      <td>24</td>\n",
       "      <td>3424</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Loss</th>\n",
       "      <th>Aru</th>\n",
       "      <td>33</td>\n",
       "      <td>3433</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"3\" valign=\"top\">Substandard</th>\n",
       "      <th>Dar</th>\n",
       "      <td>29</td>\n",
       "      <td>3529</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Mby</th>\n",
       "      <td>22</td>\n",
       "      <td>34522</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Mza</th>\n",
       "      <td>40</td>\n",
       "      <td>4034</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"5\" valign=\"top\">NMB</th>\n",
       "      <th>Current</th>\n",
       "      <th>Dar</th>\n",
       "      <td>31</td>\n",
       "      <td>4531</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Doubtful</th>\n",
       "      <th>Mby</th>\n",
       "      <td>21</td>\n",
       "      <td>2441</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">ESM</th>\n",
       "      <th>Mby</th>\n",
       "      <td>61</td>\n",
       "      <td>3681</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Tan</th>\n",
       "      <td>31</td>\n",
       "      <td>34531</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Loss</th>\n",
       "      <th>Mza</th>\n",
       "      <td>26</td>\n",
       "      <td>23556</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                              Age  Amount\n",
       "Bank Classification Location             \n",
       "CRDB Current        Aru        28   54328\n",
       "                    Dar        24    3424\n",
       "     Loss           Aru        33    3433\n",
       "     Substandard    Dar        29    3529\n",
       "                    Mby        22   34522\n",
       "                    Mza        40    4034\n",
       "NMB  Current        Dar        31    4531\n",
       "     Doubtful       Mby        21    2441\n",
       "     ESM            Mby        61    3681\n",
       "                    Tan        31   34531\n",
       "     Loss           Mza        26   23556"
      ]
     },
     "execution_count": 191,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#group by Bank, Classification, and Location\n",
    "df.groupby(by=[\"Bank\", \"Classification\", \"Location\"]).sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 192,
   "id": "d5793ea2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>Bank</th>\n",
       "      <th>Amount</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Classification</th>\n",
       "      <th>Location</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">Current</th>\n",
       "      <th>Aru</th>\n",
       "      <td>CRDB</td>\n",
       "      <td>54328</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Dar</th>\n",
       "      <td>NMB</td>\n",
       "      <td>4531</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Doubtful</th>\n",
       "      <th>Mby</th>\n",
       "      <td>NMB</td>\n",
       "      <td>2441</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">ESM</th>\n",
       "      <th>Mby</th>\n",
       "      <td>NMB</td>\n",
       "      <td>3356</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Tan</th>\n",
       "      <td>NMB</td>\n",
       "      <td>34531</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">Loss</th>\n",
       "      <th>Aru</th>\n",
       "      <td>CRDB</td>\n",
       "      <td>3433</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Mza</th>\n",
       "      <td>NMB</td>\n",
       "      <td>23556</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"3\" valign=\"top\">Substandard</th>\n",
       "      <th>Dar</th>\n",
       "      <td>CRDB</td>\n",
       "      <td>3529</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Mby</th>\n",
       "      <td>CRDB</td>\n",
       "      <td>34522</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Mza</th>\n",
       "      <td>CRDB</td>\n",
       "      <td>4034</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                         Bank  Amount\n",
       "Classification Location              \n",
       "Current        Aru       CRDB   54328\n",
       "               Dar        NMB    4531\n",
       "Doubtful       Mby        NMB    2441\n",
       "ESM            Mby        NMB    3356\n",
       "               Tan        NMB   34531\n",
       "Loss           Aru       CRDB    3433\n",
       "               Mza        NMB   23556\n",
       "Substandard    Dar       CRDB    3529\n",
       "               Mby       CRDB   34522\n",
       "               Mza       CRDB    4034"
      ]
     },
     "execution_count": 192,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Group by classification and location, showing columns of bank and maximum amount\n",
    "df5 = df[['Bank','Classification','Amount','Location']]\n",
    "df5.groupby(by=[\"Classification\",\"Location\"]).max()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 193,
   "id": "d1e38134",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead tr th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe thead tr:last-of-type th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th colspan=\"4\" halign=\"left\">Amount</th>\n",
       "      <th colspan=\"3\" halign=\"left\">Age</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>min</th>\n",
       "      <th>mean</th>\n",
       "      <th>max</th>\n",
       "      <th>sum</th>\n",
       "      <th>min</th>\n",
       "      <th>mean</th>\n",
       "      <th>max</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Bank</th>\n",
       "      <th>Location</th>\n",
       "      <th>Classification</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th rowspan=\"6\" valign=\"top\">CRDB</th>\n",
       "      <th rowspan=\"2\" valign=\"top\">Aru</th>\n",
       "      <th>Current</th>\n",
       "      <td>54328</td>\n",
       "      <td>54328.0</td>\n",
       "      <td>54328</td>\n",
       "      <td>54328</td>\n",
       "      <td>28</td>\n",
       "      <td>28.0</td>\n",
       "      <td>28</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Loss</th>\n",
       "      <td>3433</td>\n",
       "      <td>3433.0</td>\n",
       "      <td>3433</td>\n",
       "      <td>3433</td>\n",
       "      <td>33</td>\n",
       "      <td>33.0</td>\n",
       "      <td>33</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">Dar</th>\n",
       "      <th>Current</th>\n",
       "      <td>3424</td>\n",
       "      <td>3424.0</td>\n",
       "      <td>3424</td>\n",
       "      <td>3424</td>\n",
       "      <td>24</td>\n",
       "      <td>24.0</td>\n",
       "      <td>24</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Substandard</th>\n",
       "      <td>3529</td>\n",
       "      <td>3529.0</td>\n",
       "      <td>3529</td>\n",
       "      <td>3529</td>\n",
       "      <td>29</td>\n",
       "      <td>29.0</td>\n",
       "      <td>29</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Mby</th>\n",
       "      <th>Substandard</th>\n",
       "      <td>34522</td>\n",
       "      <td>34522.0</td>\n",
       "      <td>34522</td>\n",
       "      <td>34522</td>\n",
       "      <td>22</td>\n",
       "      <td>22.0</td>\n",
       "      <td>22</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Mza</th>\n",
       "      <th>Substandard</th>\n",
       "      <td>4034</td>\n",
       "      <td>4034.0</td>\n",
       "      <td>4034</td>\n",
       "      <td>4034</td>\n",
       "      <td>40</td>\n",
       "      <td>40.0</td>\n",
       "      <td>40</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"5\" valign=\"top\">NMB</th>\n",
       "      <th>Dar</th>\n",
       "      <th>Current</th>\n",
       "      <td>4531</td>\n",
       "      <td>4531.0</td>\n",
       "      <td>4531</td>\n",
       "      <td>4531</td>\n",
       "      <td>31</td>\n",
       "      <td>31.0</td>\n",
       "      <td>31</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">Mby</th>\n",
       "      <th>Doubtful</th>\n",
       "      <td>2441</td>\n",
       "      <td>2441.0</td>\n",
       "      <td>2441</td>\n",
       "      <td>2441</td>\n",
       "      <td>21</td>\n",
       "      <td>21.0</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ESM</th>\n",
       "      <td>325</td>\n",
       "      <td>1840.5</td>\n",
       "      <td>3356</td>\n",
       "      <td>3681</td>\n",
       "      <td>25</td>\n",
       "      <td>30.5</td>\n",
       "      <td>36</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Mza</th>\n",
       "      <th>Loss</th>\n",
       "      <td>23556</td>\n",
       "      <td>23556.0</td>\n",
       "      <td>23556</td>\n",
       "      <td>23556</td>\n",
       "      <td>26</td>\n",
       "      <td>26.0</td>\n",
       "      <td>26</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Tan</th>\n",
       "      <th>ESM</th>\n",
       "      <td>34531</td>\n",
       "      <td>34531.0</td>\n",
       "      <td>34531</td>\n",
       "      <td>34531</td>\n",
       "      <td>31</td>\n",
       "      <td>31.0</td>\n",
       "      <td>31</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                             Amount                        Age          \n",
       "                                min     mean    max    sum min  mean max\n",
       "Bank Location Classification                                            \n",
       "CRDB Aru      Current         54328  54328.0  54328  54328  28  28.0  28\n",
       "              Loss             3433   3433.0   3433   3433  33  33.0  33\n",
       "     Dar      Current          3424   3424.0   3424   3424  24  24.0  24\n",
       "              Substandard      3529   3529.0   3529   3529  29  29.0  29\n",
       "     Mby      Substandard     34522  34522.0  34522  34522  22  22.0  22\n",
       "     Mza      Substandard      4034   4034.0   4034   4034  40  40.0  40\n",
       "NMB  Dar      Current          4531   4531.0   4531   4531  31  31.0  31\n",
       "     Mby      Doubtful         2441   2441.0   2441   2441  21  21.0  21\n",
       "              ESM               325   1840.5   3356   3681  25  30.5  36\n",
       "     Mza      Loss            23556  23556.0  23556  23556  26  26.0  26\n",
       "     Tan      ESM             34531  34531.0  34531  34531  31  31.0  31"
      ]
     },
     "execution_count": 193,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#using aggregate function to aggregate min, mean, max, and sum in grouping\n",
    "df.groupby(['Bank','Location','Classification']).agg({'Amount':['min','mean','max','sum'], 'Age':['min','mean','max']})\n",
    "#'Classification',"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 180,
   "id": "83bd2336",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Bank</th>\n",
       "      <th>Classification</th>\n",
       "      <th>Age</th>\n",
       "      <th>Amount</th>\n",
       "      <th>Location</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>CRDB</td>\n",
       "      <td>Current</td>\n",
       "      <td>24</td>\n",
       "      <td>3424</td>\n",
       "      <td>Dar</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>CRDB</td>\n",
       "      <td>Current</td>\n",
       "      <td>28</td>\n",
       "      <td>54328</td>\n",
       "      <td>Aru</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>CRDB</td>\n",
       "      <td>Substandard</td>\n",
       "      <td>40</td>\n",
       "      <td>4034</td>\n",
       "      <td>Mza</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>CRDB</td>\n",
       "      <td>Substandard</td>\n",
       "      <td>22</td>\n",
       "      <td>34522</td>\n",
       "      <td>Mby</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>CRDB</td>\n",
       "      <td>Substandard</td>\n",
       "      <td>29</td>\n",
       "      <td>3529</td>\n",
       "      <td>Dar</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>CRDB</td>\n",
       "      <td>Loss</td>\n",
       "      <td>33</td>\n",
       "      <td>3433</td>\n",
       "      <td>Aru</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>NMB</td>\n",
       "      <td>ESM</td>\n",
       "      <td>31</td>\n",
       "      <td>34531</td>\n",
       "      <td>Tan</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>NMB</td>\n",
       "      <td>Loss</td>\n",
       "      <td>26</td>\n",
       "      <td>23556</td>\n",
       "      <td>Mza</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>NMB</td>\n",
       "      <td>Doubtful</td>\n",
       "      <td>21</td>\n",
       "      <td>2441</td>\n",
       "      <td>Mby</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>NMB</td>\n",
       "      <td>ESM</td>\n",
       "      <td>36</td>\n",
       "      <td>3356</td>\n",
       "      <td>Mby</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>NMB</td>\n",
       "      <td>ESM</td>\n",
       "      <td>25</td>\n",
       "      <td>325</td>\n",
       "      <td>Mby</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>NMB</td>\n",
       "      <td>Current</td>\n",
       "      <td>31</td>\n",
       "      <td>4531</td>\n",
       "      <td>Dar</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    Bank Classification  Age  Amount Location\n",
       "0   CRDB        Current   24    3424      Dar\n",
       "1   CRDB        Current   28   54328      Aru\n",
       "2   CRDB    Substandard   40    4034      Mza\n",
       "3   CRDB    Substandard   22   34522      Mby\n",
       "4   CRDB    Substandard   29    3529      Dar\n",
       "5   CRDB           Loss   33    3433      Aru\n",
       "6    NMB            ESM   31   34531      Tan\n",
       "7    NMB           Loss   26   23556      Mza\n",
       "8    NMB       Doubtful   21    2441      Mby\n",
       "9    NMB            ESM   36    3356      Mby\n",
       "10   NMB            ESM   25     325      Mby\n",
       "11   NMB        Current   31    4531      Dar"
      ]
     },
     "execution_count": 180,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 194,
   "id": "ee2b4fd0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>Bank</th>\n",
       "      <th>Age</th>\n",
       "      <th>Amount</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Classification</th>\n",
       "      <th>Location</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">Current</th>\n",
       "      <th>Aru</th>\n",
       "      <td>CRDB</td>\n",
       "      <td>28</td>\n",
       "      <td>54328</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Dar</th>\n",
       "      <td>NMB</td>\n",
       "      <td>31</td>\n",
       "      <td>4531</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Doubtful</th>\n",
       "      <th>Mby</th>\n",
       "      <td>NMB</td>\n",
       "      <td>21</td>\n",
       "      <td>2441</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">ESM</th>\n",
       "      <th>Mby</th>\n",
       "      <td>NMB</td>\n",
       "      <td>36</td>\n",
       "      <td>3356</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Tan</th>\n",
       "      <td>NMB</td>\n",
       "      <td>31</td>\n",
       "      <td>34531</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">Loss</th>\n",
       "      <th>Aru</th>\n",
       "      <td>CRDB</td>\n",
       "      <td>33</td>\n",
       "      <td>3433</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Mza</th>\n",
       "      <td>NMB</td>\n",
       "      <td>26</td>\n",
       "      <td>23556</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"3\" valign=\"top\">Substandard</th>\n",
       "      <th>Dar</th>\n",
       "      <td>CRDB</td>\n",
       "      <td>29</td>\n",
       "      <td>3529</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Mby</th>\n",
       "      <td>CRDB</td>\n",
       "      <td>22</td>\n",
       "      <td>34522</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Mza</th>\n",
       "      <td>CRDB</td>\n",
       "      <td>40</td>\n",
       "      <td>4034</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                         Bank  Age  Amount\n",
       "Classification Location                   \n",
       "Current        Aru       CRDB   28   54328\n",
       "               Dar        NMB   31    4531\n",
       "Doubtful       Mby        NMB   21    2441\n",
       "ESM            Mby        NMB   36    3356\n",
       "               Tan        NMB   31   34531\n",
       "Loss           Aru       CRDB   33    3433\n",
       "               Mza        NMB   26   23556\n",
       "Substandard    Dar       CRDB   29    3529\n",
       "               Mby       CRDB   22   34522\n",
       "               Mza       CRDB   40    4034"
      ]
     },
     "execution_count": 194,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#using max() function in grouping data\n",
    "df.groupby(by=[\"Classification\",\"Location\"]).max()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 195,
   "id": "c140b677",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Age</th>\n",
       "      <th>Amount</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Classification</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Current</th>\n",
       "      <td>27.666667</td>\n",
       "      <td>20761.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Doubtful</th>\n",
       "      <td>21.000000</td>\n",
       "      <td>2441.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ESM</th>\n",
       "      <td>30.666667</td>\n",
       "      <td>12737.333333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Loss</th>\n",
       "      <td>29.500000</td>\n",
       "      <td>13494.500000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Substandard</th>\n",
       "      <td>30.333333</td>\n",
       "      <td>14028.333333</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                      Age        Amount\n",
       "Classification                         \n",
       "Current         27.666667  20761.000000\n",
       "Doubtful        21.000000   2441.000000\n",
       "ESM             30.666667  12737.333333\n",
       "Loss            29.500000  13494.500000\n",
       "Substandard     30.333333  14028.333333"
      ]
     },
     "execution_count": 195,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Grouping by a single column\n",
    "df.groupby(['Classification']).mean()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 196,
   "id": "8ef92293",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead tr th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe thead tr:last-of-type th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr>\n",
       "      <th></th>\n",
       "      <th colspan=\"3\" halign=\"left\">Age</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th></th>\n",
       "      <th>min</th>\n",
       "      <th>max</th>\n",
       "      <th>mean</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Classification</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Current</th>\n",
       "      <td>24</td>\n",
       "      <td>31</td>\n",
       "      <td>27.666667</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Doubtful</th>\n",
       "      <td>21</td>\n",
       "      <td>21</td>\n",
       "      <td>21.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ESM</th>\n",
       "      <td>25</td>\n",
       "      <td>36</td>\n",
       "      <td>30.666667</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Loss</th>\n",
       "      <td>26</td>\n",
       "      <td>33</td>\n",
       "      <td>29.500000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Substandard</th>\n",
       "      <td>22</td>\n",
       "      <td>40</td>\n",
       "      <td>30.333333</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               Age               \n",
       "               min max       mean\n",
       "Classification                   \n",
       "Current         24  31  27.666667\n",
       "Doubtful        21  21  21.000000\n",
       "ESM             25  36  30.666667\n",
       "Loss            26  33  29.500000\n",
       "Substandard     22  40  30.333333"
      ]
     },
     "execution_count": 196,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#grouping by a single column and put aggregate function for summary\n",
    "grouped_single = df.groupby('Classification').agg({'Age':['min','max','mean']})\n",
    "grouped_single"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 197,
   "id": "75b8f89e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead tr th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe thead tr:last-of-type th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr>\n",
       "      <th></th>\n",
       "      <th colspan=\"4\" halign=\"left\">Amount</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th></th>\n",
       "      <th>min</th>\n",
       "      <th>max</th>\n",
       "      <th>mean</th>\n",
       "      <th>sum</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Classification</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Current</th>\n",
       "      <td>3424</td>\n",
       "      <td>54328</td>\n",
       "      <td>20761.000000</td>\n",
       "      <td>62283</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Doubtful</th>\n",
       "      <td>2441</td>\n",
       "      <td>2441</td>\n",
       "      <td>2441.000000</td>\n",
       "      <td>2441</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ESM</th>\n",
       "      <td>325</td>\n",
       "      <td>34531</td>\n",
       "      <td>12737.333333</td>\n",
       "      <td>38212</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Loss</th>\n",
       "      <td>3433</td>\n",
       "      <td>23556</td>\n",
       "      <td>13494.500000</td>\n",
       "      <td>26989</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Substandard</th>\n",
       "      <td>3529</td>\n",
       "      <td>34522</td>\n",
       "      <td>14028.333333</td>\n",
       "      <td>42085</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               Amount                            \n",
       "                  min    max          mean    sum\n",
       "Classification                                   \n",
       "Current          3424  54328  20761.000000  62283\n",
       "Doubtful         2441   2441   2441.000000   2441\n",
       "ESM               325  34531  12737.333333  38212\n",
       "Loss             3433  23556  13494.500000  26989\n",
       "Substandard      3529  34522  14028.333333  42085"
      ]
     },
     "execution_count": 197,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "grouped_single = df.groupby('Classification').agg({'Amount':['min','max','mean','sum']})\n",
    "grouped_single"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 198,
   "id": "6d471296",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "            Age\n",
      "           mean\n",
      "Bank           \n",
      "CRDB  29.333333\n",
      "NMB   28.333333\n"
     ]
    }
   ],
   "source": [
    "# group by Bank, get mean value of Age for each value of Bank.\n",
    "grouped_single = df.groupby('Bank').agg({'Age':['mean']})\n",
    "\n",
    "print(grouped_single)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 199,
   "id": "c37920c0",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "     Age               \n",
      "     min       mean max\n",
      "Bank                   \n",
      "CRDB  22  29.333333  40\n",
      "NMB   21  28.333333  36\n"
     ]
    }
   ],
   "source": [
    "# group by Bank, get mean value of Age for each value of Bank.\n",
    "grouped_single = df.groupby('Bank').agg({'Age':['min','mean','max']})\n",
    "\n",
    "print(grouped_single)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 200,
   "id": "39775a59",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "            Age        \n",
      "           mean min max\n",
      "Bank                   \n",
      "CRDB  29.333333  22  40\n",
      "NMB   28.333333  21  36\n"
     ]
    }
   ],
   "source": [
    "# group by Bank, get mean, min, and max value of Age for each value of Bank.\n",
    "grouped_single = df.groupby('Bank').agg({'Age': ['mean', 'min', 'max']})\n",
    "\n",
    "print(grouped_single)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 201,
   "id": "1261af0a",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "            Age        \n",
      "           mean min max\n",
      "Bank                   \n",
      "CRDB  29.333333  22  40\n",
      "NMB   28.333333  21  36\n"
     ]
    }
   ],
   "source": [
    "# group by Bank, get mean, min, and max value of Age for each value of Bank.\n",
    "grouped_single = df.groupby('Bank').agg({'Age': ['mean', 'min', 'max']})\n",
    "\n",
    "print(grouped_single)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 202,
   "id": "e367595e",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                           Age        \n",
      "                          mean min max\n",
      "Bank Classification                   \n",
      "CRDB Current         26.000000  24  28\n",
      "     Loss            33.000000  33  33\n",
      "     Substandard     30.333333  22  40\n",
      "NMB  Current         31.000000  31  31\n",
      "     Doubtful        21.000000  21  21\n",
      "     ESM             30.666667  25  36\n",
      "     Loss            26.000000  26  26\n"
     ]
    }
   ],
   "source": [
    "# group by Bank, Classification, get mean, min, and max value of Age for each value of Bank.\n",
    "grouped_single = df.groupby(['Bank','Classification']).agg({'Age': ['mean', 'min', 'max']})\n",
    "\n",
    "print(grouped_single)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 203,
   "id": "e7704557",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                     Age  Amount\n",
      "Classification Bank             \n",
      "Current        CRDB   52   57752\n",
      "               NMB    31    4531\n",
      "Doubtful       NMB    21    2441\n",
      "ESM            NMB    92   38212\n",
      "Loss           CRDB   33    3433\n",
      "               NMB    26   23556\n",
      "Substandard    CRDB   91   42085\n"
     ]
    }
   ],
   "source": [
    "# group by Classificatin, Bank, Age, Sum for each value of Bank.\n",
    "grouped_single = df.groupby(['Classification','Bank']).sum()\n",
    "\n",
    "print(grouped_single)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d2a92494",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
